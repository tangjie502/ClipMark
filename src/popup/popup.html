
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="popup.css">
  </head>

<body>
  <div id="container">
    <!-- 顶部工具栏 -->
    <div class="top-toolbar">
      <div class="toolbar-left">
        <h2 class="app-title">📎 ClipMark</h2>
      </div>
      <div class="toolbar-right">
        <a href="#" id="batchProcess" class="icon-button" title="批量处理">📦</a>
        <a href="/options/options.html" id="options" target="_blank" class="icon-button" title="设置">⚙️</a>
      </div>
    </div>

    <!-- 选项控制区 -->
    <div class="control-section">
      <div class="option-grid">
        <a href="#" class="option-card toggle" id="downloadImages">
          <i class="check"></i>
          <div class="option-content">
            <div class="option-title">下载图片</div>
            <div class="option-desc">同时保存文档中的图片</div>
          </div>
        </a>
        
        <a href="#" class="option-card toggle" id="includeTemplate">
          <i class="check"></i>
          <div class="option-content">
            <div class="option-title">包含模板</div>
            <div class="option-desc">添加前后文档模板</div>
          </div>
        </a>
      </div>
      
      <div class="extraction-mode" id="clipOption">
        <label class="mode-label">提取模式：</label>
        <div class="mode-buttons">
          <a href="#" class="mode-button toggle" id="selected">
            <i class="check"></i>
            <span>选中文本</span>
          </a>
          <a href="#" class="mode-button toggle" id="document">
            <i class="check"></i>
            <span>整个文档</span>
          </a>
        </div>
      </div>
    </div>

    <!-- 文件名输入 -->
    <div class="input-section">
      <input type="text" id="title" placeholder="自定义文件名（可选）" class="file-input">
    </div>
    
    <!-- 预览区域 -->
    <div class="preview-area">
        <div class="preview-status" id="previewStatus">
            <div class="status-icon">📄</div>
            <div class="status-text">
                <div class="status-title">准备提取内容</div>
                <div class="status-desc">点击下方按钮开始提取当前页面内容</div>
            </div>
        </div>
        <div class="content-summary" id="contentSummary" style="display: none;">
            <div class="summary-header">
                <span class="summary-title" id="summaryTitle">内容已提取</span>
                <span class="summary-size" id="summarySize">0 字符</span>
            </div>
            <div class="summary-preview" id="summaryPreview">
                <!-- 内容摘要将显示在这里 -->
            </div>
        </div>
    </div>
    
    <!-- 主要操作区域 -->
    <div class="action-section">
      <div class="primary-actions">
        <button class="action-button primary" id="batchSelect">
          <div class="button-icon">🔗</div>
          <div class="button-text">
            <div class="button-title">批量选择</div>
            <div class="button-subtitle">从页面选择链接进行批量处理</div>
          </div>
        </button>
      </div>
      
      <div class="secondary-actions" id="secondaryActions" style="display: none;">
        <div class="action-row">
          <button class="action-button secondary" id="preview">
            <div class="button-icon">👁️</div>
            <div class="button-text">预览</div>
          </button>
          
          <button class="action-button secondary" id="download">
            <div class="button-icon">⬇️</div>
            <div class="button-text">下载</div>
          </button>
          
          <button class="action-button secondary" id="copy">
            <div class="button-icon">📋</div>
            <div class="button-text">复制</div>
          </button>
        </div>
        
        <div class="action-row selection-actions" id="selectionActions" style="display: none;">
          <button class="action-button outline" id="downloadSelection">
            <div class="button-icon">📝</div>
            <div class="button-text">下载选中</div>
          </button>
          
          <button class="action-button outline" id="copySelection">
            <div class="button-icon">📄</div>
            <div class="button-text">复制选中</div>
          </button>
        </div>
      </div>
    </div>
  </div>
  <div id="batchContainer" style="display: none;">
    <h2 class="batch-title">批量处理</h2>
    <div class="button-row">
        <a href="#" class="button link-selector-btn" id="selectFromPage">📎 从页面选择链接</a>
    </div>
    <textarea id="urlList" placeholder="输入要转换的网址（每行一个）&#10;或使用上面的按钮从当前页面选择&#10;示例：&#10;https://example.com/page1&#10;https://example.com/page2"></textarea>
    <div class="button-row">
        <a href="#" class="button" id="convertUrls">全部转换</a>
        <a href="#" class="button" id="cancelBatch">取消</a>
    </div>
    <div id="progressContainer" style="display: none;">
      <div class="progress-header">
          <span id="progressStatus">正在处理网址...</span>
          <span id="progressCount">0/0</span>
      </div>
      <div class="progress-bar-container">
          <div id="progressBar"></div>
      </div>
      <div id="currentUrl"></div>
  </div>
</div>

<!-- 大批量处理专用界面 -->
<div id="largeBatchContainer" style="display: none;">
    <div class="large-batch-header">
        <h2 class="batch-title">🚀 批量处理进行中</h2>
        <button class="cancel-button" id="cancelLargeBatch" title="取消处理">❌</button>
    </div>
    
    <div class="batch-stats">
        <div class="stat-item">
            <div class="stat-value" id="completedCount">0</div>
            <div class="stat-label">已完成</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="totalCount">0</div>
            <div class="stat-label">总数量</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="successCount">0</div>
            <div class="stat-label">成功</div>
        </div>
        <div class="stat-item">
            <div class="stat-value" id="errorCount">0</div>
            <div class="stat-label">失败</div>
        </div>
    </div>
    
    <div class="large-progress-container">
        <div class="large-progress-header">
            <span id="largeProgressStatus">正在初始化...</span>
            <span id="largeProgressPercent">0%</span>
        </div>
        <div class="large-progress-bar-container">
            <div id="largeProgressBar" class="large-progress-bar"></div>
        </div>
        <div class="batch-time-info">
            <span id="elapsedTime">已用时: 0秒</span>
            <span id="estimatedTime">预计剩余: --</span>
        </div>
    </div>
    
    <div class="current-processing">
        <div class="processing-label">当前处理:</div>
        <div id="currentProcessingUrl" class="processing-url">--</div>
    </div>
    
    <div class="batch-log-container">
        <div class="log-header">
            <span>处理日志</span>
            <button id="toggleLog" class="toggle-log-button">展开</button>
        </div>
        <div id="batchLog" class="batch-log" style="display: none;"></div>
    </div>
    
    <div class="large-batch-actions">
        <button id="pauseResumeBatch" class="action-button secondary" style="display: none;">暂停</button>
        <button id="completeBatch" class="action-button primary" style="display: none;">查看结果</button>
    </div>
</div>
  <div id="spinner"></div>
  <script type="application/javascript" src="../browser-polyfill.min.js"></script>
  <script type="application/javascript" src="popup.js"></script>
</body>

</html>